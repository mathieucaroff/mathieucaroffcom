---
import type { Project } from "../lib/github"

interface Props {
  project: Project
}

const { project } = Astro.props

function formatDate(date: Date): string {
  return new Intl.DateTimeFormat("en-US", {
    year: "numeric",
    month: "short",
    day: "numeric",
  }).format(date)
}
---

<article
  class="project mb-6 scroll-mt-8 rounded-lg border-2 border-[rgba(100,100,100,0.3)] bg-[rgba(250,250,250,0.85)] p-6 backdrop-blur-[15px] transition-all duration-300 ease-in-out target:border-[rgba(0,102,204,0.8)] target:bg-[rgba(255,255,255,0.9)] target:shadow-[0_0_15px_rgba(0,102,204,0.4)] hover:border-[rgba(0,102,204,0.5)] hover:bg-[rgba(255,255,255,0.9)]"
  id={`project-${project.id}`}
>
  <div class="project-content flex flex-col items-start gap-6 md:flex-row">
    <div class="project-info min-w-0 flex-1">
      <h3 class="mb-3 text-[1.25rem] text-neutral-900">
        {project.title}
        {
          project.archived && (
            <span class="archived-badge ml-3 inline-block rounded bg-[rgba(255,193,7,0.8)] px-3 py-1 align-middle text-xs font-semibold text-black uppercase">
              Archived
            </span>
          )
        }
      </h3>

      <p class="description mb-4 leading-relaxed">{project.description}</p>

      <div class="metadata mb-4 text-sm">
        {
          project.languages.length > 0 && (
            <div class="languages mb-2 text-neutral-600">
              <strong>Language(s):</strong>
              {project.languages.map((lang, i) => (
                <span class="language">
                  {lang}
                  {i < project.languages.length - 1 ? ", " : ""}
                </span>
              ))}
            </div>
          )
        }

        {
          project.topics.length > 0 && (
            <div class="topics mb-2 flex flex-wrap items-center gap-2">
              {project.topics.map((topic) => (
                <span class="topic rounded bg-[#e0e0e0] px-2 py-1 text-sm">
                  {topic}
                </span>
              ))}
            </div>
          )
        }

        <div class="dates flex flex-wrap gap-3 text-neutral-500">
          <span><strong>Created:</strong> {formatDate(project.createdAt)}</span>
          <span><strong>Updated:</strong> {formatDate(project.updatedAt)}</span>
        </div>
      </div>

      <div class="links flex flex-wrap gap-4">
        <a
          href={project.repoUrl}
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-1 rounded bg-[#0066cc] px-4 py-2 font-medium text-white no-underline hover:bg-[#0052a3] hover:no-underline"
        >
          <i class="fa fa-github"></i> Repository
        </a>
        {
          project.liveUrl && (
            <a
              href={project.liveUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-1 rounded bg-[#0066cc] px-4 py-2 font-medium text-white no-underline hover:bg-[#0052a3] hover:no-underline"
            >
              <i class="fa fa-external-link" /> Start
            </a>
          )
        }
      </div>
    </div>

    {
      project.imageUrl && (
        <div class="project-image w-full shrink-0 md:w-[400px] md:max-w-[45%]">
          <a href={project.liveUrl}>
            <img
              src={project.imageUrl}
              alt={`${project.title} preview`}
              loading="lazy"
              class="h-auto max-h-[300px] w-full rounded-md border border-black/20 object-cover"
            />
          </a>
        </div>
      )
    }
  </div>
</article>
